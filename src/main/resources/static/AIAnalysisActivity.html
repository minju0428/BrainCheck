<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI 분석 결과 상세</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 커스텀 Tailwind 설정 (생략) */
        :root {
            --primary-purple: #a238ff;
            --secondary-pink: #ff3ca6;
            --purple-light: #f3e8ff;
            --blue-main: #3b82f6;

            /* 배경 그라데이션 보라색 계열 */
            --bg-gradient: radial-gradient(circle at top left, #e0f2fe 0%, #f3e8ff 50%, #ffffff 100%);
        }

        /* 폰트 설정 (생략) */
        body {
            font-family: 'Inter', sans-serif;
            /* 보라색 배경 그라데이션 적용 */
            background: var(--bg-gradient);
            min-height: 100vh; /* 페이지 전체 높이에 적용 */
        }

        /* MBTI 결과 박스 스타일 (생략) */
        .result-box {
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        /* 상세 지표 막대 컨테이너 (생략) */
        .bar-container {
            display: flex;
            align-items: center;
            height: 25px; /* 막대 높이 */
            border-radius: 9999px; /* 둥근 모서리 */
            overflow: hidden;
            /* 막대 반대편 배경을 밝은 보라색 계열로 조정 */
            background-color: var(--purple-light); /* #f3e8ff */
        }

        /* 상세 지표 막대 (T/J/E 쪽) (생략) */
        .bar-segment {
            height: 100%;
            /* 막대 색상을 보라색으로 변경 */
            background-color: var(--primary-purple); /* #a238ff */
            transition: width 0.5s ease-in-out;
            white-space: nowrap;
            padding-left: 0.5rem;
            display: flex;
            align-items: center;
            color: white;
            font-size: 0.875rem; /* text-sm */
            font-weight: 600;
        }

        /* 상세 지표 막대 (반대쪽) (생략) */
        .bar-reverse-segment {
            height: 100%;
            transition: width 0.5s ease-in-out;
            white-space: nowrap;
            padding-right: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            /* 반대쪽 텍스트 색상을 보라색으로 변경 */
            color: var(--primary-purple); /* #a238ff */
            font-size: 0.875rem; /* text-sm */
            font-weight: 600;
        }

        /* 차원 비교 카드 스타일 (생략) */
        .dimension-card {
            padding: 1.25rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 0.75rem;
        }
        .dimension-card > div:not(:first-child) {
            align-self: center;
        }

        /* 차원 아이콘 원형 스타일 (생략) */
        .dimension-icon {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.125rem;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        /* 설득 대결 버튼 그라데이션 (생략) */
        .persuade-button {
            background: linear-gradient(135deg, #ef4444, #f472b6);
            transition: all 0.3s ease;
        }
        .persuade-button:hover {
            background: linear-gradient(135deg, #dc2626, #ec4899);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
        }
    </style>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="flex justify-center py-10 md:py-16 px-4">

<div class="max-w-xl w-full space-y-8">

    <div class="text-center mb-6">
        <h1 class="text-2xl font-bold text-gray-800">
            ${characterName}
        </h1>
        <p class="text-gray-500 text-lg">
            ${titleName}
        </p>
    </div>



    <div class="grid grid-cols-2 gap-4">

        <div class="result-box bg-purple-50 space-y-3">
            <div class="flex items-center text-purple-700">
                <i data-lucide="user" class="w-5 h-5 mr-2"></i>
                <span class="font-semibold">당신이 예측한 MBTI</span>
            </div>
            <div class="p-3 bg-white rounded-lg w-fit text-xl font-bold text-purple-600 shadow-md">
                ${predictedMbti_1}
            </div>
        </div>

        <div class="result-box bg-blue-50 space-y-3">
            <div class="flex items-center text-blue-700">
                <i data-lucide="brain" class="w-5 h-5 mr-2"></i>
                <span class="font-semibold">AI가 분석한 MBTI</span>
            </div>
            <div class="p-3 bg-white rounded-lg w-fit text-xl font-bold text-blue-600 shadow-md">
                ${predictedMbti_2}
            </div>
        </div>
    </div>

    <div class="bg-white p-6 rounded-xl shadow-lg space-y-5">
        <h2 class="text-lg font-bold text-gray-800 flex items-center">
            <i data-lucide="activity" class="w-5 h-5 mr-2 text-blue-500"></i> AI 분석 상세 지표
        </h2>

        <div>
            <div class="flex justify-between text-sm font-semibold text-gray-700 mb-1">
                <span>E 외향</span>
                <span>에너지의 방향성</span>
                <span>내향 I</span>
            </div>
            <div class="bar-container">
                <div class="bar-segment" style="width: ${valueE}%;"> ${valueE}%</div>
                <div class="bar-reverse-segment" style="width: ${valueI}%;"> ${valueI}%</div>
            </div>
        </div>

        <div>
            <div class="flex justify-between text-sm font-semibold text-gray-700 mb-1">
                <span>S 감각</span>
                <span>인식 기능</span>
                <span>직관 N</span>
            </div>
            <div class="bar-container">
                <div class="bar-segment" style="width: ${valueS}%;"> ${valueS}%</div>
                <div class="bar-reverse-segment" style="width: ${valueN}%;"> ${valueN}%</div>
            </div>
        </div>

        <div>
            <div class="flex justify-between text-sm font-semibold text-gray-700 mb-1">
                <span>T 사고</span>
                <span>판단 기능</span>
                <span>감정 F</span>
            </div>
            <div class="bar-container">
                <div class="bar-segment" style="width: ${valueT}%;"> ${valueT}%</div>
                <div class="bar-reverse-segment" style="width: ${valueF}%;"> ${valueF}%</div>
            </div>
        </div>

        <div>
            <div class="flex justify-between text-sm font-semibold text-gray-700 mb-1">
                <span>J 판단</span>
                <span>생활 양식</span>
                <span>인식 P</span>
            </div>
            <div class="bar-container">
                <div class="bar-segment" style="width: ${valueJ}%;"> ${valueJ}%</div>
                <div class="bar-reverse-segment" style="width: ${valueP}%;"> ${valueP}%</div>
            </div>
        </div>

        <div class="pt-4 border-t border-gray-100">
            <p class="text-sm text-gray-600 flex items-center">
                <i data-lucide="lightbulb" class="w-4 h-4 mr-1 text-yellow-500 fill-yellow-200"></i>
                <span class="font-semibold text-orange-500 mr-1">분석 신뢰도:</span>
                AI는 각 차원을 ${confidence}% 이상의 확신도로 분석했습니다.
            </p>
        </div>
    </div>

    <div id="mbti-message-container">
    </div>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
        <div class="dimension-card bg-orange-50">
            <p class="text-sm font-bold text-gray-800 text-left w-full">에너지 방향</p>
            <div class="flex items-center gap-2">
                <div class="dimension-icon bg-purple-500 text-white">E</div>
                <div class="dimension-icon bg-red-500 text-white">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </div>
                <div class="dimension-icon bg-blue-500 text-white">I</div>
            </div>
            <span class="text-sm font-semibold text-red-600">불일치</span>
        </div>

        <div class="dimension-card bg-orange-50">
            <p class="text-sm font-bold text-gray-800 text-left w-full">인식 기능</p>
            <div class="flex items-center gap-2">
                <div class="dimension-icon bg-purple-500 text-white">N</div>
                <div class="dimension-icon bg-red-500 text-white">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </div>
                <div class="dimension-icon bg-blue-500 text-white">S</div>
            </div>
            <span class="text-sm font-semibold text-red-600">불일치</span>
        </div>

        <div class="dimension-card bg-green-50">
            <p class="text-sm font-bold text-gray-800 text-left w-full">판단 기능</p>
            <div class="flex items-center gap-2">
                <div class="dimension-icon bg-green-500 text-white">T</div>
                <div class="dimension-icon bg-green-500 text-white">
                    <i data-lucide="check" class="w-5 h-5"></i>
                </div>
                <div class="dimension-icon bg-green-500 text-white">T</div>
            </div>
            <span class="text-sm font-semibold text-green-600">일치</span>
        </div>

        <div class="dimension-card bg-green-50">
            <p class="text-sm font-bold text-gray-800 text-left w-full">생활 양식</p>
            <div class="flex items-center gap-2">
                <div class="dimension-icon bg-green-500 text-white">J</div>
                <div class="dimension-icon bg-green-500 text-white">
                    <i data-lucide="check" class="w-5 h-5"></i>
                </div>
                <div class="dimension-icon bg-green-500 text-white">J</div>
            </div>
            <span class="text-sm font-semibold text-green-600">일치</span>
        </div>
    </div>

    <div class="bg-white p-5 rounded-xl shadow-lg">
        <h3 class="text-base font-bold text-gray-800 mb-4">설득 대상 차원</h3>
        <div class="flex flex-wrap gap-3">
            <button class="px-4 py-2 bg-orange-100 hover:bg-orange-200 text-orange-700 font-semibold rounded-lg transition-colors text-sm">
                E/I (에너지 방향)
            </button>
            <button class="px-4 py-2 bg-orange-100 hover:bg-orange-200 text-orange-700 font-semibold rounded-lg transition-colors text-sm">
                S/N (인식 기능)
            </button>
        </div>
    </div>

    <div class="flex justify-center pt-4">
        <button class="persuade-button w-full max-w-md py-4 rounded-full text-white font-bold text-lg shadow-lg flex items-center justify-center gap-3">
            <i data-lucide="swords" class="w-6 h-6"></i>
            <span>설득 대결 시작하기</span>
        </button>
    </div>


</div>

<script>
    // Lucide Icons 초기화 (아이콘 렌더링)
    lucide.createIcons();

    // --------------------------------------------------
    // MBTI 결과 일치/불일치에 따른 메시지 렌더링 로직 추가
    // --------------------------------------------------

    // 자바(JSP/Thymeleaf 등)에서 전달받아야 하는 변수입니다.
    // true: 일치, false: 불일치 (기존 UI 유지)
    // 예: const isMbtiMatch = ${isMbtiMatch}; // 자바 서버 측 코드
    const isMbtiMatch = false; // 테스트를 위해 일단 '불일치'로 가정 (ENTJ vs ISTJ)

    const container = document.getElementById('mbti-message-container');
    //isMbtiMatch가 전달받은 변수
    if (isMbtiMatch) {
        // 1. 결과 일치 UI (초록색 뉘앙스)
        container.innerHTML = `
            <div class="bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3">
                <div class="flex-shrink-0">
                    <i data-lucide="check-circle" class="w-6 h-6 text-green-500"></i>
                </div>
                <p class="text-sm text-green-800 flex-1 leading-relaxed">
                    <span class="font-semibold">분석이 일치합니다!</span> 당신이 예측한 MBTI와 AI의 분석 결과가 완벽하게 일치했습니다.
                </p>
            </div>
        `;
    } else {
        // 2. 결과 불일치 UI (기존 주황색 경고 UI)
        container.innerHTML = `
            <div class="bg-orange-50 border border-orange-200 rounded-xl p-4 flex items-start gap-3">
                <div class="flex-shrink-0">
                    <i data-lucide="alert-triangle" class="w-6 h-6 text-orange-500"></i>
                </div>
                <p class="text-sm text-orange-800 flex-1 leading-relaxed">
                    <span class="font-semibold">분석 차이가 발견되었습니다.</span> AI와 2개의 출처가 서로 다른 분석 결과를 도출했습니다. 작품의 근거와 논리로 AI를 설득해주세요!
                </p>
            </div>
        `;
    }

    // 조건부 렌더링 후 Lucide 아이콘 다시 생성 (새로 추가된 아이콘 렌더링을 위해)
    lucide.createIcons();
</script>
</body>
</html>